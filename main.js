(()=>{"use strict";var t=document.querySelectorAll(".popup"),e=document.forms["popup-editUser"],r=(document.forms["popup-addCard"],e.querySelector("#name")),n=e.querySelector("#aboutMe"),o=document.querySelector(".info__editing-btn"),i=document.querySelector(".profile__add-btn"),u=document.querySelector(".popup_editUser"),a=document.querySelector(".popup_addCards"),l=document.querySelector(".popup_bigImg"),c=document.querySelector(".gallery__list");function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==s(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===s(o)?o:String(o)),n)}var o}var p=function(){function t(e,r,n){var o=e.name,i=e.link;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._title=o,this._urlImg=i,this._templateSelector=r,this._handleCardClick=n}var e,r;return e=t,(r=[{key:"_getTemplate",value:function(){return this._itemCard=document.querySelector(this._templateSelector).content.querySelector(".gallery__item").cloneNode(!0),this._itemCard}},{key:"makeCard",value:function(){return this._cardElement=this._getTemplate(),this._cardImg=this._cardElement.querySelector(".card__img"),this._cardImg.src=this._urlImg,this._cardImg.alt="Картинка с красивым видом на ".concat(this._title),this._cardElement.querySelector(".card__title").textContent=this._title,this._setEventListener(),this._cardElement}},{key:"_toggleLike",value:function(t){t.target.classList.toggle("card__btn_like_liked")}},{key:"_deleteCard",value:function(t){t.target.closest(".gallery__item").remove()}},{key:"_setEventListener",value:function(){var t=this;this._cardElement.querySelector(".card__btn_like").addEventListener("click",(function(e){t._toggleLike(e)})),this._cardElement.querySelector(".card__btn_basket").addEventListener("click",(function(e){t._deleteCard(e)})),this._cardImg.addEventListener("click",(function(){t._handleCardClick(t._title,t._urlImg)}))}}])&&f(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function m(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==y(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===y(o)?o:String(o)),n)}var o}var b=function(){function t(e,r){var n=e.data,o=e.renderer;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._items=n,this._renderer=o,this._containerSelector=r}var e,r;return e=t,(r=[{key:"renderCards",value:function(){var t=this;this._items.forEach((function(e){t._renderer(e)}))}},{key:"addItem",value:function(t){this._containerSelector.prepend(t)}}])&&m(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function h(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==d(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===d(o)?o:String(o)),n)}var o}var v=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this._selector=t,this._buttonKey="Escape",this._handleEscClose=this._handleEscClose.bind(this)}var r,n;return r=e,(n=[{key:"open",value:function(){this._selector.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this._selector.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}},{key:"_handleEscClose",value:function(t){t.key===this._buttonKey&&this.close()}},{key:"setEventListeners",value:function(){var e=this;t.forEach((function(t){t.addEventListener("mousedown",(function(t){(t.target.classList.contains("popup_opened")||t.target.classList.contains("popup__close"))&&e.close()}))}))}}])&&h(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),e}();function _(t){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_(t)}function g(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==_(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===_(o)?o:String(o)),n)}var o}function S(){return S="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=w(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},S.apply(this,arguments)}function w(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=j(t)););return t}function E(t,e){return E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},E(t,e)}function k(t,e){if(e&&("object"===_(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function j(t){return j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},j(t)}var x=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&E(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=j(n);if(o){var r=j(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return k(this,t)});function u(t,e,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(n=i.call(this,t))._name=e,n._link=r,n._popupImages=t.querySelector(".popup__image"),n._popupTitleBigImg=t.querySelector(".popup__title_bigImg"),n}return e=u,(r=[{key:"open",value:function(){this._popupImages.src=this._link,this._popupImages.alt=this._name,this._popupTitleBigImg.textContent=this._name,S(j(u.prototype),"open",this).call(this)}}])&&g(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),u}(v);function O(t){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O(t)}function P(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==O(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==O(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===O(o)?o:String(o)),n)}var o}function C(){return C="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=q(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},C.apply(this,arguments)}function q(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=B(t)););return t}function L(t,e){return L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},L(t,e)}function I(t,e){if(e&&("object"===O(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function B(t){return B=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},B(t)}var M=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&L(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=B(n);if(o){var r=B(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return I(this,t)});function u(t){var e,r=t.selector,n=t.handleFormSubmit;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(e=i.call(this,r))._handleFormSubmit=n,e._inputList=document.querySelectorAll(".popup__input"),e._formElement=r.querySelector(".popup__form"),e._userTitle=document.querySelector(".info__title"),e._textAboutMe=document.querySelector(".info__subtitle"),e._inputName=document.querySelector("#name"),e._inputAboutMe=document.querySelector("#aboutMe"),e}return e=u,(r=[{key:"_getInputValues",value:function(){var t=this;return this.inputValues={},this._inputList.forEach((function(e){t.inputValues[e.name]=e.value})),this.inputValues}},{key:"open",value:function(){this._inputName.value=this._userTitle.textContent,this._inputAboutMe.value=this._textAboutMe.textContent,C(B(u.prototype),"open",this).call(this)}},{key:"close",value:function(){this._formElement.reset(),C(B(u.prototype),"close",this).call(this)}},{key:"setEventListeners",value:function(){var t=this;this._formElement.addEventListener("submit",(function(e){e.preventDefault(),t._handleFormSubmit(t._getInputValues())})),C(B(u.prototype),"setEventListeners",this).call(this)}}])&&P(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),u}(v);function T(t){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T(t)}function A(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==T(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==T(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===T(o)?o:String(o)),n)}var o}var H=function(){function t(e){var r=e.name,n=e.aboutMe;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._userName=r,this._userInfo=n,this._userTitle=document.querySelector(".info__title"),this._textAboutMe=document.querySelector(".info__subtitle")}var e,r;return e=t,(r=[{key:"getUserInfo",value:function(){return{userName:this._userName.value,userAboutMe:this._userInfo.value}}},{key:"setUserInfo",value:function(){var t=this.getUserInfo();this._userTitle.textContent=t.userName,this._textAboutMe.textContent=t.userAboutMe}}])&&A(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function R(t){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R(t)}function V(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==R(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==R(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===R(o)?o:String(o)),n)}var o}var D=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._settings=r,this._formElem=e}var e,r;return e=t,(r=[{key:"_showError",value:function(t){this._textError=this._formElem.querySelector(".".concat(t.id,"-error")),t.classList.add(this._settings.inputErrorClass),this._textError.textContent=t.validationMessage,this._textError.classList.add(this._settings.errorClass)}},{key:"hideError",value:function(t){this._textError=this._formElem.querySelector(".".concat(t.id,"-error")),t.classList.remove(this._settings.inputErrorClass),this._textError.textContent="",this._textError.classList.remove(this._settings.errorClass)}},{key:"_checkInputValidity",value:function(t){t.validity.valid?this.hideError(t):this._showError(t)}},{key:"_checkInputItems",value:function(){return this._inputs.some((function(t){return!t.validity.valid}))}},{key:"_setEventListeners",value:function(){var t=this;this._inputs=Array.from(this._formElem.querySelectorAll(this._settings.inputSelector)),this._popupBtn=this._formElem.querySelector(this._settings.submitButtonSelector),this._changeButtonStyle(),this._inputs.forEach((function(e){e.addEventListener("input",(function(){t._checkInputValidity(e),t._changeButtonStyle()}))}))}},{key:"resetValidation",value:function(){var t=this;this._changeButtonStyle(),this._inputs.forEach((function(e){t.hideError(e)}))}},{key:"_changeButtonStyle",value:function(){this._checkInputItems()?(this._popupBtn.classList.add(this._settings.inactiveButtonClass),this._popupBtn.setAttribute("disabled","disabled")):(this._popupBtn.classList.remove(this._settings.inactiveButtonClass),this._popupBtn.removeAttribute("disabled","disabled"))}},{key:"enableValidation",value:function(){this._setEventListeners()}}])&&V(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function G(t){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G(t)}function U(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==G(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==G(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===G(o)?o:String(o)),n)}var o}function N(t,e,r){return e&&U(t.prototype,e),r&&U(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var W,Y=N((function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._options=e})),F={};W={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__btn",inactiveButtonClass:"popup__btn_disabled",inputErrorClass:"popup__input_error",errorClass:"popup__text-error_active"},Array.from(document.querySelectorAll(W.formSelector)).forEach((function(t){var e=new D(t,W),r=t.getAttribute("name");F[r]=e,e.enableValidation()}));var K=new M({selector:u,handleFormSubmit:function(){z.setUserInfo(),K.close()}}),z=new H({name:r,aboutMe:n}),J=new M({selector:a,handleFormSubmit:function(t){var e={};e.name=t.place,e.link=t.linkImg,c.prepend(Z(e)),J.close()}}),Q=new b({data:[{name:"Южная Африка",link:"https://images.unsplash.com/photo-1484318571209-661cf29a69c3?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1170&q=80"},{name:"Великая Китайская Стена",link:"https://images.unsplash.com/photo-1508804185872-d7badad00f7d?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1170&q=80"},{name:"Кипр",link:"https://images.unsplash.com/photo-1560860446-c821e910a0a7?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1074&q=80"},{name:"Судак",link:"https://images.unsplash.com/photo-1565342403917-671ac824577c?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1210&q=80"},{name:"Канада",link:"https://images.unsplash.com/photo-1527489377706-5bf97e608852?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1259&q=80"},{name:"Байкал",link:"https://images.unsplash.com/photo-1548130516-2ca6aaeb84b9?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1170&q=80"}],renderer:function(t){Q.addItem(Z(t))}},c);function X(t,e){var r=new x(l,t,e);r.open(),r.setEventListeners()}function Z(t){return new p(t,"#templateCard",X).makeCard()}Q.renderCards(),new Y({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-58",headers:{authorization:"7c807b84-450d-4868-9be8-1ddb6e4753bd","Content-Type":"application/json"}}),o.addEventListener("click",(function(){K.open(),z.getUserInfo(),z.setUserInfo(),F["popup-editUser"].resetValidation()})),K.setEventListeners(),i.addEventListener("click",(function(){J.open(),F["popup-addCard"].resetValidation()})),J.setEventListeners()})();